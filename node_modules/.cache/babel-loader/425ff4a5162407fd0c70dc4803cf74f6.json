{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Ankur\\\\Desktop\\\\therapidhire\\\\therapidhireui\\\\TheRapidHireUI\\\\src\\\\video\\\\video.js\";\nimport React, { Component } from 'react';\nimport Header from './header/header';\nimport { Button, Media, Row, Col, FormControl, InputGroup } from 'react-bootstrap';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { captureUserMedia } from './AppUtils'; //import { ToastContainer } from 'react-toastify';\n\nimport Slider from 'react-slick';\nimport _ from 'lodash'; //import Webcam from './Webcam.react';\n\nimport Webcam from \"react-webcam\"; //import  \"https://cdn.rawgit.com/mattdiamond/Recorderjs/08e7abd9/dist/recorder.js\";\n//import * as AWS from \"https://sdk.amazonaws.com/js/aws-sdk-2.2.32.min.js\";\n//import Summary from './summary/addSummary';\n\nimport VideoPlayer from 'react-video-js-player'; //import CompetencyRecommendations from '../profile/competency/recommendations/competencyWiseRecommendations';\n\nimport ImageCropper from './../common/cropper/imageCropper';\nimport DownloadLink from \"react-download-link\"; //import Img from '../../common/cropper/img';\n\nimport { showErrorToast, uploadToAzure, limitCharacter, SampleNextArrow, SamplePrevArrow, getThumbImage } from './../common/commonFunctions';\nimport theRapidHireApiService from './../common/core/api/apiService';\nimport CONSTANTS from './../common/core/config/appConfig'; //import videojs from 'video.js'\n\nimport { actionGetStudentPersonalInfo, actionGetAllCompetency, actionGetAchievementsByUser, actionGetRecommendationsByUser, actionUpdateUserInfo, actionGetAchievementsData } from './../common/core/redux/actions';\nimport $ from 'jquery';\nimport SpiderChart from './../common/spiderChart/spiderChart';\n\nvar AWS = require('aws-sdk'); //loadScript('https://sdk.amazonaws.com/js/aws-sdk-2.2.32.min.js')\n\n\nconst config = {\n  bucketName: 'ankurself',\n  dirName: 'photos',\n\n  /* optional */\n  region: 'ap-south-1',\n  // Put your aws region here\n  accessKeyId: 'AKIAJHHM3PCJ25PK6OWQ',\n  secretAccessKey: 'fTo0CpSivV7OWo2TrFGNUaA5E6ST1pB9Pwnsp5HB'\n};\nvar settings = {\n  dots: false,\n  infinite: false,\n  speed: 500,\n  slidesToShow: 3,\n  swipeToSlide: true,\n  //nextArrow: <SampleNextArrow props={this.props} />,\n  //prevArrow: <SamplePrevArrow props={this.props} />,\n  responsive: [{\n    breakpoint: 1024,\n    settings: {\n      slidesToShow: 3,\n      slidesToScroll: 3,\n      infinite: true,\n      dots: true\n    }\n  }, {\n    breakpoint: 600,\n    settings: {\n      slidesToShow: 2,\n      slidesToScroll: 2,\n      initialSlide: 2\n    }\n  }, {\n    breakpoint: 480,\n    settings: {\n      slidesToShow: 1,\n      slidesToScroll: 1\n    }\n  }]\n};\nconst hasGetUserMedia = !!(navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia);\n\nclass Video extends Component {\n  constructor(props, context) {\n    super(props);\n    this.state = {\n      video: {\n        src: \"http://www.example.com/path/to/video.mp4\",\n        poster: \"http://www.example.com/path/to/video_poster.jpg\"\n      },\n      showJobDescriptionComponent: false,\n      jobDescriptionDetail: {},\n      loader1: false,\n      loader2: false,\n      jobDescriptionListData: [],\n      userData: {},\n      showDropdown: false,\n      isActive: 'true',\n      contentEditable: false,\n      editName: false,\n      name: '',\n      editTagLine: false,\n      showVideo: false\n    };\n    var wRegion = \"ap-south-1\";\n    var poolid = 'ap-south-1:5075a328-2598-4e55-ba57-d4b60ed9548c';\n    var s3bucketName = \"ankurself\";\n    var audioPath = \"/audio-files\";\n    var s3bucketName = \"ankurself\";\n    var audioPath = \"/audio-files\";\n    var audioStoreWithBucket = s3bucketName + audioPath; //AudioStream = new AudioStream(wRegion,poolid,s3bucketName+audioPath)\n\n    this.region = \"ap-south-1\"; //s3 region\n\n    this.IdentityPoolId = 'ap-south-1:5075a328-2598-4e55-ba57-d4b60ed9548c'; //identity pool id\n\n    this.bucketName = audioStoreWithBucket; //audio file store\n\n    this.s3 = null; //variable defination for s3\n\n    this.dateinfo = new Date();\n    this.timestampData = this.dateinfo.getTime(); //timestamp used for file uniqueness\n\n    this.etag = []; // etag is used to save the parts of the single upload file\n\n    this.recordedChunks = []; //empty Array\n\n    this.booleanStop = false; // this is for final multipart complete\n\n    this.incr = 0; // multipart requires incremetal so that they can merge all parts by ascending order\n\n    this.filename = this.timestampData.toString() + \".webm\"; //unique filename\n\n    this.uploadId = \"\"; // upload id is required in multipart\n\n    this.recorder = null; //initializing recorder variable\n\n    this.player = null; //To use microphone it shud be {audio: true}\n\n    this.audioConstraints = {\n      //  audio: true,\n      video: true\n    };\n  }\n\n  componentWillMount() {\n    //let userId = this.props.user.userId;\n    document.body.classList.add('light-theme');\n    document.body.classList.add('absoluteHeader');\n    document.body.classList.remove('home');\n    document.body.classList.remove('fixedHeader');\n    this.audioStreamInitialize();\n  }\n\n  componentWillReceiveProps(res) {// this.setProfileData(res.user);\n    // this.setAchievementData(res.student.achievementData);\n    // this.renderRecommendationsByUserId();\n  }\n\n  componentDidMount() {\n    let user = this.props.user.userId;\n    console.log(user);\n\n    if (!hasGetUserMedia) {\n      alert(\"Your browser cannot stream from your webcam. Please switch to Chrome or Firefox.\");\n      return;\n    }\n\n    const script = document.createElement(\"script\");\n    script.src = \"https://cdn.rawgit.com/mattdiamond/Recorderjs/08e7abd9/dist/recorder.js\";\n    script.async = true;\n    document.body.appendChild(script);\n\n    if (this.props.student.achievementData) {\n      console.log(this.props.student.achievementData);\n    }\n  }\n\n  onPlayerReady(player) {\n    console.log(\"Player is ready: \", player);\n    this.player = player;\n  }\n\n  onVideoPlay(duration) {\n    console.log(\"Video played at: \", duration);\n  }\n\n  onVideoPause(duration) {\n    console.log(\"Video paused at: \", duration);\n  }\n\n  onVideoTimeUpdate(duration) {\n    console.log(\"Time updated: \", duration);\n  }\n\n  onVideoSeeking(duration) {\n    console.log(\"Video seeking: \", duration);\n  }\n\n  onVideoSeeked(from, to) {\n    console.log(\"Video seeked from \".concat(from, \" to \").concat(to));\n  }\n\n  onVideoEnd() {\n    console.log(\"Video ended\");\n  }\n\n  audioStreamInitialize() {\n    /*\r\n        Creates a new credentials object, which will allow us to communicate with the aws services.\r\n    */\n    var self = this;\n    AWS.config.update({\n      region: \"ap-south-1\",\n      credentials: new AWS.CognitoIdentityCredentials({\n        IdentityPoolId: 'ap-south-1:5075a328-2598-4e55-ba57-d4b60ed9548c',\n        RoleArn: 'arn:aws:iam::923146643705:role/Cognito_TestPoolUnauth_Role',\n        AccountId: '923146643705' // your AWS account ID\n\n      })\n    });\n    AWS.config.credentials.get(function (err) {\n      if (err) console.log(err);else console.log(AWS.config.credentials);\n    });\n    /*\r\n       Constructs a service object.\r\n    */\n    // self.s3 = new AWS.S3({apiVersion: '2006-03-01',\n    //                     params: {Bucket: 'ankurself'},\n    // }\n    // );\n\n    self.s3 = new AWS.S3({\n      logger: console,\n      //         AWSAccessKeyId=AKIAJRQYW4X2EL2WE6UQ\n      // AWSSecretKey=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\n      apiVersion: '2006-03-01',\n      params: {\n        Bucket: 'ankurself'\n      }\n    });\n    /*\r\n        Feature detecting is a simple check for the existence of \"navigator.mediaDevices.getUserMedia\"\r\n        To use the microphone. we need to request permission.\r\n        The parameter to getUserMedia() is an object specifying the details and requirements for each type of media you want to access.\r\n        To use microphone it shud be {audio: true}\r\n    */\n\n    navigator.mediaDevices.getUserMedia(self.audioConstraints).then(function (stream) {\n      /*\r\n          once we accept the prompt for the audio stream from user's mic we enable the record button.\r\n      */\n      $(\"#record_q1\").removeAttr(\"disabled\");\n      /*\r\n          Creates a new MediaRecorder object, given a MediaStream to record.\r\n      */\n\n      self.recorder = new MediaRecorder(stream); //    self.setState({videosrc:stream});\n\n      /*\r\n          Called to handle the dataavailable event, which is periodically triggered each time timeslice milliseconds of media have been recorded\r\n          (or when the entire media has been recorded, if timeslice wasn't specified).\r\n          The event, of type BlobEvent, contains the recorded media in its data property.\r\n          You can then collect and act upon that recorded media data using this event handler.\r\n      */\n\n      self.recorder.addEventListener('dataavailable', function (e) {\n        var normalArr = [];\n        /*\r\n            Here we push the stream data to an array for future use.\r\n        */\n\n        self.recordedChunks.push(e.data);\n        normalArr.push(e.data);\n        /*\r\n            here we create a blob from the stream data that we have received.\r\n        */\n\n        var blob = new Blob(normalArr, {\n          type: 'video/webm'\n        });\n        /*\r\n            if the length of recordedChunks is 1 then it means its the 1st part of our data.\r\n            So we createMultipartUpload which will return an upload id.\r\n            Upload id is used to upload the other parts of the stream\r\n            else.\r\n            It Uploads a part in a multipart upload.\r\n        */\n\n        if (self.recordedChunks.length == 1) {\n          console.log(blob.size);\n          self.startMultiUpload(blob, self.filename);\n        } else {\n          /*\r\n              self.incr is basically a part number.\r\n              Part number of part being uploaded. This is a positive integer between 1 and 10,000.\r\n          */\n          self.incr = self.incr + 1;\n          self.continueMultiUpload(blob, self.incr, self.uploadId, self.filename, self.bucketName);\n        }\n      });\n    });\n  }\n\n  startRecording(id) {\n    var self = this; // self.enableAllButton();\n    //  $(\"#record_q1\").attr(\"disabled\", \"disabled\");\n\n    /*\r\n        1800000 is the number of milliseconds to record into each Blob.\r\n        If this parameter isn't included, the entire media duration is recorded into a single Blob unless the requestData()\r\n        method is called to obtain the Blob and trigger the creation of a new Blob into which the media continues to be recorded.\r\n    */\n\n    /*\r\n    PLEASE NOTE YOU CAN CHANGE THIS PARAM OF 1800000 but the size should be greater then or equal to 5MB.\r\n    As for multipart upload the minimum breakdown of the file should be 5MB\r\n    */\n    //this.recorder.start(1800000);\n\n    this.recorder.start(1800000);\n    console.log('recprdomg');\n    this.setState({\n      showVideo: true\n    });\n  }\n\n  stopRecording(id) {\n    var self = this;\n    self.recorder.stop();\n    /*\r\n        Once the recording is stop we change the flag of self.booleanStop to true.\r\n        which means we have completed the recording and now we can\r\n        Completes a multipart upload by assembling previously uploaded parts.\r\n    */\n\n    self.booleanStop = true; //disable self\n\n    self.disableAllButton();\n    $(\"#stop_q1\").attr(\"disabled\", \"disabled\"); // add loader\n    //  self.setLoader();\n\n    this.setState({\n      showVideo: false\n    });\n  }\n\n  pauseRecording(id) {\n    var self = this;\n    self.recorder.pause();\n    $(\"#pause_q1\").addClass(\"hide\");\n    $(\"#resume_q1\").removeClass(\"hide\");\n  }\n\n  resumeRecording(id) {\n    var self = this;\n    self.recorder.resume();\n    $(\"#resume_q1\").addClass(\"hide\");\n    $(\"#pause_q1\").removeClass(\"hide\");\n  }\n\n  startMultiUpload(blob, filename) {\n    var self = this;\n    var audioBlob = blob;\n    var params = {\n      Bucket: 'ankurself',\n      Key: filename,\n      ContentType: 'video/webm',\n      ACL: 'public-read'\n    }; // self.s3.getSignedUrl('postObject', params, function (err, url) {\n    //       if(err){\n    //         console.log(err);\n    //       }\n    //       console.log(url);\n    //          });\n\n    self.s3.createMultipartUpload(params, function (err, data) {\n      if (err) {\n        console.log(err, err.stack); // an error occurred\n      } else {\n        self.uploadId = data.UploadId;\n        self.incr = 1;\n        self.continueMultiUpload(audioBlob, self.incr, self.uploadId, self.filename, self.bucketName);\n      }\n    });\n  }\n  /*\r\n        Uploads a part in a multipart upload.\r\n        The following code uploads part of a multipart upload.\r\n        it specifies a file name for the part data. The Upload ID is same that is returned by the initiate multipart upload.\r\n    */\n\n\n  continueMultiUpload(audioBlob, PartNumber, uploadId, key, bucketName) {\n    var self = this;\n    var params = {\n      Body: audioBlob,\n      Bucket: 'ankurself',\n      Key: key,\n      PartNumber: PartNumber,\n      UploadId: uploadId\n    };\n    console.log(params);\n    self.s3.uploadPart(params, function (err, data) {\n      if (err) {\n        console.log(err, err.stack);\n      } // an error occurred\n      else {\n          /*\r\n              Once the part of data is uploaded we get an Entity tag for the uploaded object(ETag).\r\n              which is used later when we complete our multipart upload.\r\n          */\n          self.etag.push(data.ETag);\n\n          if (self.booleanStop == true) {\n            self.completeMultiUpload();\n          }\n        }\n    });\n  }\n  /*\r\n        Completes a multipart upload by assembling previously uploaded parts.\r\n    */\n\n\n  completeMultiUpload() {\n    var self = this;\n    var outputTag = [];\n    /*\r\n        here we are constructing the Etag data in the required format.\r\n    */\n\n    self.etag.forEach((data, index) => {\n      const obj = {\n        ETag: data,\n        PartNumber: ++index\n      };\n      outputTag.push(obj);\n    });\n    var params = {\n      Bucket: 'ankurself',\n      // required\n      Key: self.filename,\n      // required\n      UploadId: self.uploadId,\n      // required\n      MultipartUpload: {\n        Parts: outputTag\n      }\n    };\n    self.s3.completeMultipartUpload(params, function (err, data) {\n      if (err) {\n        console.log(err, err.stack);\n      } // an error occurred\n      else {\n          console.log(data.Location);\n          self.saveVideoURL(data.Location); // initialize variable back to normal\n\n          self.etag = [];\n          self.recordedChunks = [];\n          self.uploadId = \"\";\n          self.booleanStop = false;\n          self.disableAllButton(); //   self.removeLoader();\n\n          alert(\"we have successfully saved the questionaire..\");\n        }\n    });\n  }\n\n  saveVideoURL(videoLink) {\n    let data = {\n      userId: this.props.user.userId,\n      videoLink\n    };\n    theRapidHireApiService('addVideo', data).then(response => {\n      if (response.data.statusCode === 200) {\n        let userData = this.state.userData;\n        userData = response.data.resourceData[0];\n        console.log(response.data.resourceData[0]);\n        this.setState({\n          userData: userData\n        });\n      }\n    }).catch(err => {\n      console.log(err);\n    });\n  }\n\n  disableAllButton() {\n    $(\"#formdata button[type=button]\").attr(\"disabled\", \"disabled\");\n  }\n\n  enableAllButton() {\n    $(\"#formdata button[type=button]\").removeAttr(\"disabled\");\n  }\n\n  render() {\n    const videoConstraints = {\n      facingMode: \"user\"\n    };\n    return React.createElement(\"div\", {\n      className: \"wrapper\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 525\n      },\n      __self: this\n    }, React.createElement(Header, Object.assign({}, this.props, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 526\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"main-panel\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 527\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"w3-content main-panel1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 529\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 530\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-md-12\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 531\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"card\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 532\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 533\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 534\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"panel-group\",\n      id: \"accordion\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 535\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      onClick: this.startRecording.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 536\n      },\n      __self: this\n    }, \"Start Record\"), React.createElement(\"button\", {\n      onClick: this.stopRecording.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 537\n      },\n      __self: this\n    }, \"stop Record\"), this.state.uploading ? React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 539\n      },\n      __self: this\n    }, \"Uploading...\") : null, this.state.showVideo ? React.createElement(Webcam, {\n      videoConstraints: videoConstraints,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 543\n      },\n      __self: this\n    }) : null)))))))));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    user: state.User.userData,\n    parent: state.User.parentData,\n    student: state.Student\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return bindActionCreators({\n    actionGetStudentPersonalInfo,\n    actionGetAllCompetency,\n    actionGetAchievementsByUser,\n    actionGetRecommendationsByUser,\n    actionUpdateUserInfo,\n    actionGetAchievementsData\n  }, dispatch);\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Video);","map":{"version":3,"sources":["C:\\Users\\Ankur\\Desktop\\therapidhire\\therapidhireui\\TheRapidHireUI\\src\\video\\video.js"],"names":["React","Component","Header","Button","Media","Row","Col","FormControl","InputGroup","connect","bindActionCreators","captureUserMedia","Slider","_","Webcam","VideoPlayer","ImageCropper","DownloadLink","showErrorToast","uploadToAzure","limitCharacter","SampleNextArrow","SamplePrevArrow","getThumbImage","theRapidHireApiService","CONSTANTS","actionGetStudentPersonalInfo","actionGetAllCompetency","actionGetAchievementsByUser","actionGetRecommendationsByUser","actionUpdateUserInfo","actionGetAchievementsData","$","SpiderChart","AWS","require","config","bucketName","dirName","region","accessKeyId","secretAccessKey","settings","dots","infinite","speed","slidesToShow","swipeToSlide","responsive","breakpoint","slidesToScroll","initialSlide","hasGetUserMedia","navigator","getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","Video","constructor","props","context","state","video","src","poster","showJobDescriptionComponent","jobDescriptionDetail","loader1","loader2","jobDescriptionListData","userData","showDropdown","isActive","contentEditable","editName","name","editTagLine","showVideo","wRegion","poolid","s3bucketName","audioPath","audioStoreWithBucket","IdentityPoolId","s3","dateinfo","Date","timestampData","getTime","etag","recordedChunks","booleanStop","incr","filename","toString","uploadId","recorder","player","audioConstraints","componentWillMount","document","body","classList","add","remove","audioStreamInitialize","componentWillReceiveProps","res","componentDidMount","user","userId","console","log","alert","script","createElement","async","appendChild","student","achievementData","onPlayerReady","onVideoPlay","duration","onVideoPause","onVideoTimeUpdate","onVideoSeeking","onVideoSeeked","from","to","onVideoEnd","self","update","credentials","CognitoIdentityCredentials","RoleArn","AccountId","get","err","S3","logger","apiVersion","params","Bucket","mediaDevices","then","stream","removeAttr","MediaRecorder","addEventListener","e","normalArr","push","data","blob","Blob","type","length","size","startMultiUpload","continueMultiUpload","startRecording","id","start","setState","stopRecording","stop","disableAllButton","attr","pauseRecording","pause","addClass","removeClass","resumeRecording","resume","audioBlob","Key","ContentType","ACL","createMultipartUpload","stack","UploadId","PartNumber","key","Body","uploadPart","ETag","completeMultiUpload","outputTag","forEach","index","obj","MultipartUpload","Parts","completeMultipartUpload","Location","saveVideoURL","videoLink","response","statusCode","resourceData","catch","enableAllButton","render","videoConstraints","facingMode","bind","uploading","mapStateToProps","User","parent","parentData","Student","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport Header from './header/header';\r\nimport {\r\n  Button,\r\n  Media,\r\n  Row,\r\n  Col,\r\n  FormControl,\r\n  InputGroup\r\n} from 'react-bootstrap';\r\nimport { connect } from 'react-redux';\r\nimport { bindActionCreators } from 'redux';\r\nimport { captureUserMedia } from './AppUtils';\r\n//import { ToastContainer } from 'react-toastify';\r\nimport Slider from 'react-slick';\r\nimport _ from 'lodash';\r\n\r\n//import Webcam from './Webcam.react';\r\nimport Webcam from \"react-webcam\";\r\n//import  \"https://cdn.rawgit.com/mattdiamond/Recorderjs/08e7abd9/dist/recorder.js\";\r\n//import * as AWS from \"https://sdk.amazonaws.com/js/aws-sdk-2.2.32.min.js\";\r\n//import Summary from './summary/addSummary';\r\n\r\nimport VideoPlayer from 'react-video-js-player';\r\n//import CompetencyRecommendations from '../profile/competency/recommendations/competencyWiseRecommendations';\r\nimport ImageCropper from './../common/cropper/imageCropper';\r\nimport DownloadLink from \"react-download-link\";\r\n//import Img from '../../common/cropper/img';\r\nimport {\r\n  showErrorToast,\r\n  uploadToAzure,\r\n  limitCharacter,\r\n  SampleNextArrow,\r\n  SamplePrevArrow,\r\n  getThumbImage\r\n} from './../common/commonFunctions';\r\nimport theRapidHireApiService from './../common/core/api/apiService';\r\nimport CONSTANTS from './../common/core/config/appConfig';\r\n\r\n//import videojs from 'video.js'\r\n\r\nimport {\r\n  actionGetStudentPersonalInfo,\r\n  actionGetAllCompetency,\r\n  actionGetAchievementsByUser,\r\n  actionGetRecommendationsByUser,\r\n  actionUpdateUserInfo,\r\n  actionGetAchievementsData\r\n} from './../common/core/redux/actions';\r\nimport $ from 'jquery'; \r\nimport SpiderChart from './../common/spiderChart/spiderChart';\r\nvar AWS = require('aws-sdk');\r\n\r\n  //loadScript('https://sdk.amazonaws.com/js/aws-sdk-2.2.32.min.js')\r\n\r\n\r\nconst config = {\r\n  bucketName: 'ankurself',\r\n  dirName: 'photos', /* optional */\r\n  region: 'ap-south-1', // Put your aws region here\r\n  accessKeyId: 'AKIAJHHM3PCJ25PK6OWQ',\r\n  secretAccessKey: 'fTo0CpSivV7OWo2TrFGNUaA5E6ST1pB9Pwnsp5HB'\r\n}\r\n\r\n\r\nvar settings = {\r\n  dots: false,\r\n  infinite: false,\r\n  speed: 500,\r\n  slidesToShow: 3,\r\n  swipeToSlide: true,\r\n  //nextArrow: <SampleNextArrow props={this.props} />,\r\n  //prevArrow: <SamplePrevArrow props={this.props} />,\r\n  responsive: [\r\n    {\r\n      breakpoint: 1024,\r\n      settings: {\r\n        slidesToShow: 3,\r\n        slidesToScroll: 3,\r\n        infinite: true,\r\n        dots: true\r\n      }\r\n    },\r\n    {\r\n      breakpoint: 600,\r\n      settings: {\r\n        slidesToShow: 2,\r\n        slidesToScroll: 2,\r\n        initialSlide: 2\r\n      }\r\n    },\r\n    {\r\n      breakpoint: 480,\r\n      settings: {\r\n        slidesToShow: 1,\r\n        slidesToScroll: 1\r\n      }\r\n    }\r\n  ]\r\n};\r\n\r\nconst hasGetUserMedia = !!(navigator.getUserMedia || navigator.webkitGetUserMedia ||\r\n    navigator.mozGetUserMedia || navigator.msGetUserMedia);\r\n\r\nclass Video extends Component {\r\n  constructor(props, context) {\r\n    super(props);\r\n   \r\n    this.state = {  \r\n        video: {\r\n            src: \"http://www.example.com/path/to/video.mp4\",\r\n            poster: \"http://www.example.com/path/to/video_poster.jpg\"\r\n        },    \r\n      showJobDescriptionComponent: false,      \r\n      jobDescriptionDetail: {},        \r\n     \r\n      loader1: false,\r\n      loader2: false,      \r\n      jobDescriptionListData: [],     \r\n      userData:{},     \r\n      showDropdown: false,     \r\n      isActive: 'true',     \r\n      contentEditable: false,\r\n      editName: false,\r\n      name: '',\r\n      editTagLine: false,\r\n      showVideo:false\r\n    };\r\n    var wRegion = \"ap-south-1\";\r\n    var poolid = 'ap-south-1:5075a328-2598-4e55-ba57-d4b60ed9548c';\r\n    var s3bucketName = \"ankurself\";\r\n    var audioPath = \"/audio-files\";\r\n    var s3bucketName = \"ankurself\";\r\n    var audioPath = \"/audio-files\";\r\n    var audioStoreWithBucket=s3bucketName+audioPath;\r\n    //AudioStream = new AudioStream(wRegion,poolid,s3bucketName+audioPath)\r\n\r\n    this.region = \"ap-south-1\"; //s3 region\r\n    this.IdentityPoolId = 'ap-south-1:5075a328-2598-4e55-ba57-d4b60ed9548c'; //identity pool id\r\n    this.bucketName = audioStoreWithBucket; //audio file store\r\n    this.s3=null; //variable defination for s3\r\n    this.dateinfo = new Date();\r\n    this.timestampData = this.dateinfo.getTime(); //timestamp used for file uniqueness\r\n    this.etag = []; // etag is used to save the parts of the single upload file\r\n    this.recordedChunks = []; //empty Array\r\n    this.booleanStop = false; // this is for final multipart complete\r\n    this.incr = 0; // multipart requires incremetal so that they can merge all parts by ascending order\r\n    this.filename = this.timestampData.toString() + \".webm\"; //unique filename\r\n    this.uploadId = \"\"; // upload id is required in multipart\r\n    this.recorder=null; //initializing recorder variable\r\n    this.player=null;\r\n    //To use microphone it shud be {audio: true}\r\n    this.audioConstraints = {\r\n      //  audio: true,\r\n        video: true\r\n    };    \r\n  }\r\n\r\n  componentWillMount() {\r\n    //let userId = this.props.user.userId;\r\n    \r\n    document.body.classList.add('light-theme');\r\n    document.body.classList.add('absoluteHeader');\r\n    document.body.classList.remove('home');\r\n    document.body.classList.remove('fixedHeader');\r\n    this.audioStreamInitialize();\r\n  }\r\n\r\n  componentWillReceiveProps(res) {\r\n    // this.setProfileData(res.user);\r\n    // this.setAchievementData(res.student.achievementData);\r\n    // this.renderRecommendationsByUserId();\r\n  }\r\n\r\n  componentDidMount() {\r\n    let user= this.props.user.userId;\r\n    console.log(user);\r\n     if(!hasGetUserMedia) {\r\n      alert(\"Your browser cannot stream from your webcam. Please switch to Chrome or Firefox.\");\r\n      return;\r\n    }\r\n    const script = document.createElement(\"script\");\r\n\r\n    script.src = \"https://cdn.rawgit.com/mattdiamond/Recorderjs/08e7abd9/dist/recorder.js\";\r\n    script.async = true;\r\n\r\n    document.body.appendChild(script)\r\n    if (this.props.student.achievementData) {\r\n      console.log(this.props.student.achievementData);\r\n    }\r\n\r\n  }\r\n\r\n \r\n\r\nonPlayerReady(player){\r\n    console.log(\"Player is ready: \", player);\r\n    this.player = player;\r\n}\r\n\r\nonVideoPlay(duration){\r\n    console.log(\"Video played at: \", duration);\r\n}\r\n\r\nonVideoPause(duration){\r\n    console.log(\"Video paused at: \", duration);\r\n}\r\n\r\nonVideoTimeUpdate(duration){\r\n    console.log(\"Time updated: \", duration);\r\n}\r\n\r\nonVideoSeeking(duration){\r\n    console.log(\"Video seeking: \", duration);\r\n}\r\n\r\nonVideoSeeked(from, to){\r\n    console.log(`Video seeked from ${from} to ${to}`);\r\n}\r\n\r\nonVideoEnd(){\r\n    console.log(\"Video ended\");\r\n}\r\n\r\n  audioStreamInitialize() {\r\n    /*\r\n        Creates a new credentials object, which will allow us to communicate with the aws services.\r\n    */\r\n    var self = this;\r\n    AWS.config.update({\r\n         region: \"ap-south-1\",\r\n             credentials: new AWS.CognitoIdentityCredentials({\r\n                IdentityPoolId: 'ap-south-1:5075a328-2598-4e55-ba57-d4b60ed9548c',\r\n                RoleArn: 'arn:aws:iam::923146643705:role/Cognito_TestPoolUnauth_Role',\r\n                AccountId: '923146643705' // your AWS account ID\r\n\r\n             })\r\n        });\r\n\r\n            AWS.config.credentials.get(function (err) {\r\n    if (err) console.log(err);\r\n    else console.log(AWS.config.credentials);\r\n});\r\n     /*\r\n        Constructs a service object.\r\n    */\r\n    // self.s3 = new AWS.S3({apiVersion: '2006-03-01',\r\n    //                     params: {Bucket: 'ankurself'},\r\n     \r\n    // }\r\n    // );\r\n    self.s3 = new AWS.S3({logger:console,\r\n//         AWSAccessKeyId=AKIAJRQYW4X2EL2WE6UQ\r\n// AWSSecretKey=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\r\n     apiVersion: '2006-03-01',\r\n        params: {Bucket: 'ankurself'}\r\n\r\n\r\n})\r\n    /*\r\n        Feature detecting is a simple check for the existence of \"navigator.mediaDevices.getUserMedia\"\r\n        To use the microphone. we need to request permission.\r\n        The parameter to getUserMedia() is an object specifying the details and requirements for each type of media you want to access.\r\n        To use microphone it shud be {audio: true}\r\n    */\r\n    navigator.mediaDevices.getUserMedia(self.audioConstraints)\r\n        .then(function(stream) {\r\n            \r\n            /*\r\n                once we accept the prompt for the audio stream from user's mic we enable the record button.\r\n            */\r\n            $(\"#record_q1\").removeAttr(\"disabled\");\r\n            /*\r\n                Creates a new MediaRecorder object, given a MediaStream to record.\r\n            */\r\n            self.recorder = new MediaRecorder(stream);\r\n                        //    self.setState({videosrc:stream});\r\n                             \r\n            /*\r\n                Called to handle the dataavailable event, which is periodically triggered each time timeslice milliseconds of media have been recorded\r\n                (or when the entire media has been recorded, if timeslice wasn't specified).\r\n                The event, of type BlobEvent, contains the recorded media in its data property.\r\n                You can then collect and act upon that recorded media data using this event handler.\r\n            */\r\n            self.recorder.addEventListener('dataavailable', function(e) {\r\n                var normalArr = [];\r\n                /*\r\n                    Here we push the stream data to an array for future use.\r\n                */\r\n                self.recordedChunks.push(e.data);\r\n                normalArr.push(e.data);\r\n\r\n                /*\r\n                    here we create a blob from the stream data that we have received.\r\n                */\r\n                var blob = new Blob(normalArr, {\r\n                    type: 'video/webm'\r\n                });\r\n                         \r\n                /*\r\n                    if the length of recordedChunks is 1 then it means its the 1st part of our data.\r\n                    So we createMultipartUpload which will return an upload id.\r\n                    Upload id is used to upload the other parts of the stream\r\n                    else.\r\n                    It Uploads a part in a multipart upload.\r\n                */\r\n                if (self.recordedChunks.length == 1) {\r\n                         console.log(blob.size);\r\n\r\n\r\n                    self.startMultiUpload(blob, self.filename)\r\n                } else {\r\n                    /*\r\n                        self.incr is basically a part number.\r\n                        Part number of part being uploaded. This is a positive integer between 1 and 10,000.\r\n                    */\r\n                    self.incr = self.incr + 1\r\n                    self.continueMultiUpload(blob, self.incr, self.uploadId, self.filename, self.bucketName);\r\n                }\r\n            })\r\n        });\r\n}\r\n\r\n\r\n\r\nstartRecording(id) {\r\n    var self = this;\r\n  \r\n   // self.enableAllButton();\r\n  //  $(\"#record_q1\").attr(\"disabled\", \"disabled\");\r\n    /*\r\n        1800000 is the number of milliseconds to record into each Blob.\r\n        If this parameter isn't included, the entire media duration is recorded into a single Blob unless the requestData()\r\n        method is called to obtain the Blob and trigger the creation of a new Blob into which the media continues to be recorded.\r\n    */\r\n    /*\r\n    PLEASE NOTE YOU CAN CHANGE THIS PARAM OF 1800000 but the size should be greater then or equal to 5MB.\r\n    As for multipart upload the minimum breakdown of the file should be 5MB\r\n    */\r\n    //this.recorder.start(1800000);\r\n    \r\n    this.recorder.start(1800000);\r\n    console.log('recprdomg');\r\n    this.setState({showVideo:true});\r\n}\r\n\r\nstopRecording(id) {\r\n    var self = this;\r\n    self.recorder.stop();\r\n    /*\r\n        Once the recording is stop we change the flag of self.booleanStop to true.\r\n        which means we have completed the recording and now we can\r\n        Completes a multipart upload by assembling previously uploaded parts.\r\n    */\r\n    self.booleanStop = true;\r\n    //disable self\r\n    self.disableAllButton()\r\n    $(\"#stop_q1\").attr(\"disabled\", \"disabled\");\r\n    // add loader\r\n  //  self.setLoader();\r\n    this.setState({showVideo:false});\r\n}\r\n\r\npauseRecording(id) {\r\n    var self = this;\r\n    self.recorder.pause();\r\n   $(\"#pause_q1\").addClass(\"hide\");\r\n    $(\"#resume_q1\").removeClass(\"hide\");\r\n}\r\n \r\n\r\nresumeRecording(id) {\r\n    var self = this;\r\n    self.recorder.resume();\r\n   $(\"#resume_q1\").addClass(\"hide\");\r\n    $(\"#pause_q1\").removeClass(\"hide\");\r\n}\r\n\r\nstartMultiUpload(blob, filename) {\r\n    var self = this;\r\n    var audioBlob = blob;\r\n    var params = {\r\n     \r\n        Bucket: 'ankurself',\r\n        Key: filename,\r\n        ContentType: 'video/webm',\r\n        ACL: 'public-read'           \r\n    };\r\n\r\n// self.s3.getSignedUrl('postObject', params, function (err, url) {\r\n//       if(err){\r\n//         console.log(err);\r\n//       }\r\n//       console.log(url);\r\n//          });\r\n\r\n\r\n    self.s3.createMultipartUpload(params, function(err, data) {\r\n        if (err) {\r\n            console.log(err, err.stack); // an error occurred\r\n        } else {\r\n            self.uploadId = data.UploadId\r\n            self.incr = 1;\r\n            self.continueMultiUpload(audioBlob, self.incr, self.uploadId, self.filename, self.bucketName);\r\n        }\r\n    });\r\n}\r\n \r\n\r\n /*\r\n       Uploads a part in a multipart upload.\r\n       The following code uploads part of a multipart upload.\r\n       it specifies a file name for the part data. The Upload ID is same that is returned by the initiate multipart upload.\r\n   */\r\n  continueMultiUpload(audioBlob, PartNumber, uploadId, key, bucketName) {\r\n    var self = this;\r\n \r\n \r\n \r\n    var params = {\r\n        Body: audioBlob,\r\n        Bucket: 'ankurself',\r\n        Key: key,\r\n        PartNumber: PartNumber,\r\n        UploadId: uploadId\r\n    };\r\n    console.log(params);\r\n    self.s3.uploadPart(params, function(err, data) {\r\n        if (err) {\r\n            console.log(err, err.stack)\r\n        } // an error occurred\r\n        else {\r\n            /*\r\n                Once the part of data is uploaded we get an Entity tag for the uploaded object(ETag).\r\n                which is used later when we complete our multipart upload.\r\n            */\r\n            self.etag.push(data.ETag);\r\n            if (self.booleanStop == true) {\r\n                self.completeMultiUpload();\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\n\r\n /*\r\n       Completes a multipart upload by assembling previously uploaded parts.\r\n   */\r\n  completeMultiUpload() {\r\n    var self = this;\r\n    var outputTag = [];\r\n    /*\r\n        here we are constructing the Etag data in the required format.\r\n    */\r\n    self.etag.forEach((data, index) => {\r\n        const obj = {\r\n            ETag: data,\r\n            PartNumber: ++index\r\n        };\r\n        outputTag.push(obj);\r\n    });\r\n\r\n    var params = {\r\n        Bucket:'ankurself', // required\r\n        Key: self.filename, // required\r\n        UploadId: self.uploadId, // required\r\n        MultipartUpload: {\r\n            Parts: outputTag\r\n        }\r\n    };\r\n\r\n    self.s3.completeMultipartUpload(params, function(err, data) {\r\n        if (err) {\r\n            console.log(err, err.stack)\r\n        } // an error occurred\r\n        else {\r\n            console.log(data.Location);\r\n            self.saveVideoURL(data.Location);\r\n            // initialize variable back to normal\r\n            self.etag = [];\r\n            self.recordedChunks = [];\r\n            self.uploadId = \"\";\r\n            self.booleanStop = false;\r\n            self.disableAllButton();\r\n         //   self.removeLoader();\r\n            alert(\"we have successfully saved the questionaire..\");\r\n        }\r\n    });\r\n}\r\n\r\nsaveVideoURL(videoLink){\r\n    let data={\r\n          userId: this.props.user.userId,\r\n        videoLink\r\n    };\r\n\r\n    theRapidHireApiService('addVideo',data)\r\n    .then(response => {     \r\n      if (response.data.statusCode === 200) {\r\n         let userData= this.state.userData;\r\n         userData= response.data.resourceData[0];\r\n         console.log(response.data.resourceData[0]);\r\n         this.setState({userData: userData});\r\n      }\r\n    })\r\n    .catch(err => {\r\n      console.log(err);\r\n    });\r\n}\r\n\r\n\r\ndisableAllButton() {\r\n    $(\"#formdata button[type=button]\").attr(\"disabled\", \"disabled\");\r\n}\r\n\r\nenableAllButton() {\r\n    $(\"#formdata button[type=button]\").removeAttr(\"disabled\");\r\n}\r\n\r\n  render() {\r\n    const videoConstraints = {\r\n        facingMode: \"user\"\r\n      };\r\n    return (\r\n        <div className=\"wrapper\">\r\n        <Header {...this.props} />     \r\n          <div className=\"main-panel\">  \r\n\r\n        <div className=\"w3-content main-panel1\">     \r\n        <div className=\"row\">\r\n    <div className=\"col-md-12\">\r\n      <div className=\"card\">\r\n        <div className=\"header\">\r\n        <div className=\"content\">\r\n          <div className=\"panel-group\" id=\"accordion\">\r\n            <button onClick={this.startRecording.bind(this)}>Start Record</button>\r\n               <button onClick={this.stopRecording.bind(this)}>stop Record</button>\r\n                {this.state.uploading ?\r\n            <div>Uploading...</div> : null}           \r\n          \r\n       \r\n                   \r\n              {this.state.showVideo ?   <Webcam videoConstraints={videoConstraints} />: null} \r\n          \r\n       \r\n         {/* <video id='video' autoplay muted src={this.state.videosrc}/> */}\r\n           {/* <button type=\"button\" class=\"btn kc record\" id=\"record_q1\" disabled=\"disabled\" onClick={this.startRecording.bind(this)}>Record</button>\r\n           <button type=\"button\" class=\"btn kc pause\" id=\"pause_q1\" disabled=\"disabled\" onClick={this.pauseRecording.bind(this.id)}>Pause</button>\r\n           <button type=\"button\" class=\"btn kc resume hide\" id=\"resume_q1\" disabled=\"disabled\" onclick={this.resumeRecording.bind(this.id)}>Resume</button>\r\n           <button type=\"button\" class=\"btn kc stop\" id=\"stop_q1\" disabled=\"disabled\" onclick={this.stopRecording.bind(this.id)}>Stop</button> */}\r\n           </div>  \r\n            \r\n        </div>    \r\n        </div></div>  \r\n            \r\n            </div>    \r\n            </div>\r\n             </div>\r\n         </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\nconst mapStateToProps = state => {\r\n  return {\r\n    user: state.User.userData,\r\n    parent: state.User.parentData,\r\n    student: state.Student\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return bindActionCreators(\r\n    {\r\n      actionGetStudentPersonalInfo,\r\n      actionGetAllCompetency,\r\n      actionGetAchievementsByUser,\r\n      actionGetRecommendationsByUser,\r\n      actionUpdateUserInfo,\r\n      actionGetAchievementsData\r\n    },\r\n    dispatch\r\n  );\r\n};\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(Video);\r\n"]},"metadata":{},"sourceType":"module"}