{"ast":null,"code":"import axios from 'axios';\nimport ApiJson from './apiConfigJson';\nimport { showErrorToast, showSuccessToast, getAPIURL, getLocalStorage } from '../../commonFunctions';\nimport { get } from 'http';\nlet apiFailCounter = 0;\naxios.defaults.baseURL = \"https://therapidhire.herokuapp.com/\"; //  getAPIURL().httpServer + getAPIURL().APIURL + \":\" + getAPIURL().APIPort;\n\naxios.interceptors.request.use(function (config) {\n  let userInfo = getLocalStorage('userInfo');\n\n  if (userInfo) {\n    if (userInfo.token) {\n      let access_token = userInfo.token;\n      config.headers.Authorization = \"Spike \".concat(access_token);\n    }\n  }\n\n  return config;\n}, function (error) {\n  return Promise.reject(error);\n});\n\nconst prepareDataObject = (_data_, paramObj) => {\n  for (let key in _data_) {\n    if (paramObj[key] || paramObj[key] === false) {\n      _data_[key] = paramObj[key];\n    } else {\n      if (typeof _data_[key] !== 'object') _data_[key] = '';\n    }\n  }\n\n  return _data_;\n};\n\nconst injectParamsToUrl = (_url_, paramObj) => {\n  var url = _url_;\n\n  for (let key in paramObj) {\n    url = url.replace(':' + key, paramObj[key]);\n  }\n\n  return url;\n};\n\nconst handleErrorByStatus = error => {\n  if (error && error.status === 'Error') {\n    const message = error.message;\n    showErrorToast(message);\n  }\n};\n\nconst theRapidHireApiService = (apiKeyName, data) => {\n  let apiDetails = ApiJson[apiKeyName];\n\n  if (!apiDetails) {\n    console.log('Api configuration do not found in api-json, please check api-json.js');\n    throw new Error('Api configuration do not found in api-json, please check api-json.js');\n  }\n\n  let requestObject = Object.assign({}, apiDetails);\n  requestObject.data = prepareDataObject(requestObject.data, data);\n  requestObject.url = injectParamsToUrl(requestObject.url, data);\n  return axios(requestObject).then(function (result) {\n    apiFailCounter = 0;\n\n    if (result.data && result.data.status === 'Success') {\n      if (result.data.message) {\n        const message = result.data.message;\n        if (requestObject.showResultMessage === true) showSuccessToast(message);\n      }\n    } else {\n      handleErrorByStatus(result.data);\n    }\n\n    return result;\n  }).catch(function (error) {\n    console.log('error', error);\n\n    if (error && error.response) {\n      if (requestObject.showErrorMessage === true) handleErrorByStatus(error.response);\n    }\n\n    if (error.config.maxContentLength - 1 && error.toString().indexOf('Network Error') > -1) {\n      apiFailCounter++;\n\n      if (apiFailCounter >= 3) {\n        localStorage.clear();\n        window.open(window.location.origin, '_self');\n      }\n    }\n\n    return error.response;\n  });\n};\n\nexport default theRapidHireApiService;","map":{"version":3,"sources":["/home/ank/Desktop/therapidhiregit/therapidhireui/TheRapidHireUI/src/common/core/api/apiService.js"],"names":["axios","ApiJson","showErrorToast","showSuccessToast","getAPIURL","getLocalStorage","get","apiFailCounter","defaults","baseURL","interceptors","request","use","config","userInfo","token","access_token","headers","Authorization","error","Promise","reject","prepareDataObject","_data_","paramObj","key","injectParamsToUrl","_url_","url","replace","handleErrorByStatus","status","message","theRapidHireApiService","apiKeyName","data","apiDetails","console","log","Error","requestObject","Object","assign","then","result","showResultMessage","catch","response","showErrorMessage","maxContentLength","toString","indexOf","localStorage","clear","window","open","location","origin"],"mappings":"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","sourcesContent":["import axios from 'axios';\r\n\r\nimport ApiJson from './apiConfigJson';\r\nimport {\r\n  showErrorToast,\r\n  showSuccessToast,\r\n  getAPIURL,\r\n  getLocalStorage\r\n} from '../../commonFunctions';\r\nimport { get } from 'http';\r\n\r\nlet apiFailCounter = 0;\r\n\r\naxios.defaults.baseURL = \"https://therapidhire.herokuapp.com/\";\r\n //  getAPIURL().httpServer + getAPIURL().APIURL + \":\" + getAPIURL().APIPort;\r\n\r\naxios.interceptors.request.use(\r\n  function(config) {\r\n    let userInfo = getLocalStorage('userInfo');\r\n    if (userInfo) {\r\n      if (userInfo.token) {\r\n        let access_token = userInfo.token;\r\n        config.headers.Authorization = `Spike ${access_token}`;\r\n      }\r\n    }\r\n    return config;\r\n  },\r\n  function(error) {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nconst prepareDataObject = (_data_, paramObj) => {\r\n  for (let key in _data_) {\r\n    if (paramObj[key] || paramObj[key] === false) {\r\n      _data_[key] = paramObj[key];\r\n    } else {\r\n      if (typeof _data_[key] !== 'object') _data_[key] = '';\r\n    }\r\n  }\r\n  return _data_;\r\n};\r\n\r\nconst injectParamsToUrl = (_url_, paramObj) => {\r\n  var url = _url_;\r\n  for (let key in paramObj) {\r\n    url = url.replace(':' + key, paramObj[key]);\r\n  }\r\n  return url;\r\n};\r\n\r\nconst handleErrorByStatus = error => {\r\n  if (error && error.status === 'Error') {\r\n    const message = error.message;\r\n    showErrorToast(message);\r\n  }\r\n};\r\n\r\nconst theRapidHireApiService = (apiKeyName, data) => {\r\n  let apiDetails = ApiJson[apiKeyName];\r\n  if (!apiDetails) {\r\n    console.log(\r\n      'Api configuration do not found in api-json, please check api-json.js'\r\n    );\r\n    throw new Error(\r\n      'Api configuration do not found in api-json, please check api-json.js'\r\n    );\r\n  }\r\n\r\n  let requestObject = Object.assign({}, apiDetails);\r\n  requestObject.data = prepareDataObject(requestObject.data, data);\r\n  requestObject.url = injectParamsToUrl(requestObject.url, data);\r\n\r\n  return axios(requestObject)\r\n    .then(function(result) {\r\n      apiFailCounter = 0;\r\n      if (result.data && result.data.status === 'Success') {\r\n        if (result.data.message) {\r\n          const message = result.data.message;\r\n          if (requestObject.showResultMessage === true)\r\n            showSuccessToast(message);\r\n        }\r\n      } else {\r\n        handleErrorByStatus(result.data);\r\n      }\r\n      return result;\r\n    })\r\n    .catch(function(error) {\r\n      console.log('error', error);\r\n      if (error && error.response) {\r\n        if (requestObject.showErrorMessage === true)\r\n          handleErrorByStatus(error.response);\r\n      }\r\n\r\n      if (\r\n        error.config.maxContentLength - 1 &&\r\n        error.toString().indexOf('Network Error') > -1\r\n      ) {\r\n        apiFailCounter++;\r\n        if (apiFailCounter >= 3) {\r\n          localStorage.clear();\r\n          window.open(window.location.origin, '_self');\r\n        }\r\n      }\r\n      return error.response;\r\n    });\r\n};\r\n\r\nexport default theRapidHireApiService;\r\n"]},"metadata":{},"sourceType":"module"}